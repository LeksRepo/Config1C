
Процедура ОбработкаПолученияПредставления(Данные, Представление, СтандартнаяОбработка)
	
	ЛексСервер.ПолучитьПредставлениеДокумента(Данные, Представление, СтандартнаяОбработка);
	
КонецПроцедуры

Процедура Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт
	
	Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "АктПередачи") Тогда
		ПодготовитьПечатнуюФорму("АктПередачи", "Акт передачи", "Документ.АктВыполненияДоговораДилера.АктПередачи",
		МассивОбъектов, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода);
	КонецЕсли;
		
	ПараметрыВывода.ДоступнаПечатьПоКомплектно = Истина;
	
КонецПроцедуры

Процедура ПодготовитьПечатнуюФорму(Знач ИмяМакета, ПредставлениеМакета, ПолныйПутьКМакету = "", МассивОбъектов, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода)
	
	Если ИмяМакета = "АктПередачи" Тогда
		ТабДок = ПечатьАктПередачи(МассивОбъектов, ОбъектыПечати);
	КонецЕсли;
		
	УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, ИмяМакета,
	ПредставлениеМакета, ТабДок,, ПолныйПутьКМакету);
	
КонецПроцедуры

Функция ПечатьАктПередачи(МассивОбъектов, ОбъектыПечати) Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
	
	ТабДок = Новый ТабличныйДокумент;
	ТабДок.ИмяПараметровПечати = "ПараметрыПечати_АктПередачиДилера";
	ТабДок.АвтоМасштаб = Истина;
	ТабДок.ОтображатьСетку = Ложь;
	ТабДок.Защита = Ложь;
	ТабДок.ТолькоПросмотр = Ложь;
	ТабДок.ОтображатьЗаголовки = Ложь;
	
	Макет = Документы.АктВыполненияДоговораДилера.ПолучитьМакет("АктПередачиДилера");
	ОбластьТело = Макет.ПолучитьОбласть("Тело");
	
	Запрос = Новый Запрос;
	Запрос.Параметры.Вставить("МассивДокументов", МассивОбъектов.Договор);
	Запрос.Текст =
	"ВЫБРАТЬ
	|	ДоговорДилера.Номер КАК НомерДоговора,
	|	ДоговорДилера.Дата КАК ДатаДоговора,
	|	ДоговорДилера.АдресДоговора КАК Адрес,
	|	ДоговорДилера.Заказчик КАК ФИОКлиента,
	|	ДоговорДилера.Изделие КАК Изделие,
	|	ДоговорДилера.СуммаДокумента КАК СуммаДокумента,
	|	ДоговорДилера.Телефон КАК Телефон,
	|	ДоговорДилера.Ссылка КАК Ссылка,
	|	ДоговорДилера.Автор.ОбъектАвторизации.ПолноеНаименование КАК ОрганизацияПродавец,
	|	ДоговорДилера.Автор.ОбъектАвторизации.Телефон КАК ТелефонОфиса
	|ИЗ
	|	Документ.ДоговорДилера КАК ДоговорДилера
	|ГДЕ
	|	ДоговорДилера.Ссылка В(&МассивДокументов)";
	
	Выборка = Запрос.Выполнить().Выбрать();	
	
	Пока Выборка.Следующий() Цикл
		
		ОбластьТело.Параметры.Заполнить(Выборка);
		ОбластьТело.Параметры.ДатаДоговора = Формат(Выборка.ДатаДоговора, "ДЛФ=D");
		
		ТабДок.Вывести(ОбластьТело);
		ТабДок.ВывестиГоризонтальныйРазделительСтраниц();
		
		УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабДок, 1, ОбъектыПечати, Выборка.Ссылка);
		
	КонецЦикла;
	
	Возврат ТабДок;
	
КонецФункции