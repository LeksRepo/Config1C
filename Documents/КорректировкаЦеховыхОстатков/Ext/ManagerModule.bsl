
Процедура ОбработкаПолученияПредставления(Данные, Представление, СтандартнаяОбработка)
	
	ЛексСервер.ПолучитьПредставлениеДокумента(Данные, Представление, СтандартнаяОбработка);
	
КонецПроцедуры

Процедура ПечатьАктКорректировка(ТабДок, Ссылка) Экспорт
	
	ФормСтрока = "Л=ru_RU";
	ПарПредмета="рубль, рубля, рублей, м, копейка, копейки, копеек, ж, 0";
	
	Для Каждого Док Из Ссылка Цикл
		
		Макет = Документы.КорректировкаЦеховыхОстатков.ПолучитьМакет("ПечатьАктКорректировка");
		Запрос = Новый Запрос;
		Запрос.Текст =
		"ВЫБРАТЬ
		|	Корректировка.Дата,
		|	Корректировка.Номер,
		|	Корректировка.Подразделение,
		|	Корректировка.СуммаДокумента,
		|	Корректировка.СписокНоменклатуры.(
		|		НомерСтроки,
		|		Номенклатура,
		|		Номенклатура.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
		|		Оприходовать,
		|		Списать,
		|		Описание
		|	)
		|ИЗ
		|	Документ.КорректировкаЦеховыхОстатков КАК Корректировка
		|ГДЕ
		|	Корректировка.Ссылка В(&Ссылка)
		|	И Корректировка.Проведен";
		
		Запрос.Параметры.Вставить("Ссылка", Док);
		Выборка = Запрос.Выполнить().Выбрать();
		
		Шапка = Макет.ПолучитьОбласть("Шапка");
		ОбластьШапкаТаблица = Макет.ПолучитьОбласть("ШапкаТаблица");
		ОбластьСтрокаТаблица = Макет.ПолучитьОбласть("СтрокаТаблица");
		Подписи = Макет.ПолучитьОбласть("Подписи");
		
		ТабДок.ВывестиГоризонтальныйРазделительСтраниц();
		
		Пока Выборка.Следующий() Цикл
			
			Шапка.Параметры.Заполнить(Выборка);
			Шапка.Параметры.Подразделение = Док.Подразделение;
			Шапка.Параметры.Дата = Формат(Док.Дата, "ДФ=dd.MM.yyyy");
			Шапка.Параметры.Номер = ПрефиксацияОбъектовКлиентСервер.УдалитьЛидирующиеНулиИзНомераОбъекта(Док.Номер);
			
			ТабДок.Вывести(Шапка, Выборка.Уровень());
			
			ТабДок.Вывести(ОбластьШапкаТаблица);
			ВыборкаСписокНоменклатуры = Выборка.СписокНоменклатуры.Выбрать();
			Пока ВыборкаСписокНоменклатуры.Следующий() Цикл
				ОбластьСтрокаТаблица.Параметры.Заполнить(ВыборкаСписокНоменклатуры);
				ТабДок.Вывести(ОбластьСтрокаТаблица, ВыборкаСписокНоменклатуры.Уровень());
			КонецЦикла;
			
			Подписи.Параметры.Заполнить(Выборка);
			Подписи.Параметры.Сумма = Строка(Выборка.СуммаДокумента) + " ( " + ЧислоПрописью(Выборка.СуммаДокумента, ФормСтрока, ПарПредмета)+" )";
			Подписи.Параметры.ФизЛицоДиректор = ФизическиеЛицаКлиентСервер.ФамилияИнициалыФизЛица(Док.Подразделение.Руководитель);
			Подписи.Параметры.ФизЛицоУправляющий = ФизическиеЛицаКлиентСервер.ФамилияИнициалыФизЛица(Док.Подразделение.Управляющий);
			ТабДок.Вывести(Подписи);
			
			ВставлятьРазделительСтраниц = Истина;
			
		КонецЦикла;
		
	КонецЦикла;
	
КонецПроцедуры