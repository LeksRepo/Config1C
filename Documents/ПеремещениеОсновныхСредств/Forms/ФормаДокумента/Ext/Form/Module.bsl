
&НаКлиенте
Процедура Заполнить(Команда)
	
	Если ЗначениеЗаполнено(Объект.МОЛОтправитель)
	   И ЗначениеЗаполнено(Объект.МОЛПолучатель)
	   И ЗначениеЗаполнено(Объект.Подразделение) Тогда
	
		 ЗаполнитьНаСервере();
		 
	Иначе
		 
		Сообщить("Заполните Подразделение, Отправителя и Получателя"); 
		 
	КонецЕсли;
	
КонецПроцедуры

&НаСервере
Процедура ЗаполнитьНаСервере()
	
	Запрос = Новый Запрос();
	Запрос.УстановитьПараметр("МОЛ", Объект.МОЛОтправитель);
	Запрос.УстановитьПараметр("Период", ТекущаяДата());
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	Таб.ОсновноеСредство
	|ИЗ
	|	РегистрСведений.СостояниеОсновныхСредств.СрезПоследних(&Период, ) КАК Таб
	|ГДЕ
	|	Таб.МОЛ = &МОЛ
	|	И Таб.ПринятоКУчету";
	
	Объект.ОсновныеСредства.Загрузить(Запрос.Выполнить().Выгрузить());
	
КонецПроцедуры
